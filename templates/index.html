<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BMR Calculator</title>
</head>
<body>
    <h1>BMR Calculator</h1>
    <form method="POST">
        <label for="age">Age (years):</label>
        <input type="number" name="age" required><br>

        <label for="weight">Weight (kg or lbs):</label>
        <input type="number" name="weight" required><br>

        <label for="gender">Gender:</label>
        <select name="gender" required>
            <option value="male">Male</option>
            <option value="female">Female</option>
        </select><br>

        <label for="unit_system">Unit System:</label>
        <select name="unit_system" id="unit_system" required>
            <option value="metric">Metric (cm, kg)</option>
            <option value="customary">Customary (ft, in, lbs)</option>
        </select><br>

        <div id="height_metric">
            <label for="height">Height (cm):</label>
            <input type="number" name="height"><br>
        </div>

        <div id="height_customary" style="display: none;">
            <label for="height_feet">Height (feet):</label>
            <input type="number" name="height_feet" required><br>
            <label for="height_inches">Height (inches):</label>
            <input type="number" name="height_inches" required><br>
        </div>

        <label for="activity_level">Activity Level:</label>
        <select name="activity_level" required>
            <option value="sedentary">Sedentary</option>
            <option value="lightly active">Lightly Active</option>
            <option value="moderately active">Moderately Active</option>
            <option value="very active">Very Active</option>
            <option value="super active">Super Active</option>
        </select><br>

        <input type="submit" value="Calculate BMR">
    </form>

    {% if bmr %}
        <h2>Your BMR: {{ bmr }} calories</h2>
        <h3>Caloric Needs:</h3>
        <ul>
            <li>Maintain Weight: {{ caloric_needs['maintain'] }} calories</li>
            <li>Lose Weight Slowly: {{ caloric_needs['lose_weight_slowly'] }} calories</li>
            <li>Lose Weight Quickly: {{ caloric_needs['lose_weight_quickly'] }} calories</li>
            <li>Gain Weight Slowly: {{ caloric_needs['gain_weight_slowly'] }} calories</li>
            <li>Gain Weight Quickly: {{ caloric_needs['gain_weight_quickly'] }} calories</li>
        </ul>
    {% endif %}

    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <ul>
            {% for message in messages %}
                <li>{{ message }}</li>
            {% endfor %}
            </ul>
        {% endif %}
    {% endwith %}
    
    <script>
        const unitSystemSelect = document.getElementById('unit_system');
        const heightMetric = document.getElementById('height_metric');
        const heightCustomary = document.getElementById('height_customary');

        unitSystemSelect.addEventListener('change', function() {
            if (this.value === 'customary') {
                heightMetric.style.display = 'none';
                heightCustomary.style.display = 'block';
            } else {
                heightMetric.style.display = 'block';
                heightCustomary.style.display = 'none';
            }
        });
    </script>
</body>
</html>
